<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <title>thIAguinho Wii: ULTIMATE</title>
    
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-core"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-converter"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-webgl"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/pose-detection"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Russo+One&family=Roboto:wght@300;400;700&display=swap');

        :root { --wii-bg: #e6e6e6; --wii-highlight: #68c9e6; }

        body {
            background-color: #000; margin: 0; padding: 0; overflow: hidden;
            font-family: 'Roboto', sans-serif; touch-action: none; user-select: none;
            width: 100vw; height: 100dvh;
        }

        #os-layer { position: relative; width: 100%; height: 100%; background: transparent; pointer-events: none; z-index: 50; }
        #game-hardware { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; background: #000; }
        #video-source { display: none; }
        
        /* C√¢mera espelhada para sensa√ß√£o natural */
        #webcam {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover; transform: scaleX(-1); opacity: 0; transition: opacity 0.5s;
        }
        #game-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: block; }

        .screen {
            position: absolute; inset: 0; display: flex; flex-direction: column;
            align-items: center; justify-content: center; background: var(--wii-bg);
            pointer-events: auto; transition: opacity 0.3s;
        }
        .hidden { opacity: 0; pointer-events: none; z-index: -1; }

        /* MENU WII */
        #screen-menu { background: linear-gradient(#f2f2f2, #d9d9d9); justify-content: flex-start; padding-top: 5vh; }
        .wii-grid {
            display: grid; width: 95%; height: 70%; gap: 8px;
            grid-template-columns: repeat(2, 1fr); grid-template-rows: repeat(4, 1fr);
        }
        @media (min-width: 768px) {
            .wii-grid { width: 80%; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(3, 1fr); }
        }
        .channel {
            background: #fff; border-radius: 12px; border: 1px solid #ccc;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            cursor: pointer; position: relative; overflow: hidden;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.05); transition: transform 0.1s;
        }
        .channel:active { transform: scale(0.95); border-color: var(--wii-highlight); }
        .channel-icon { font-size: clamp(2rem, 5vw, 4rem); margin-bottom: 5px; }
        .channel-name { font-size: clamp(0.6rem, 2vw, 0.9rem); color: #888; font-weight: bold; text-transform: uppercase; }

        .bottom-bar {
            position: absolute; bottom: 0; width: 100%; height: 12%;
            background: #cdcdcd; border-top: 2px solid #fff;
            display: flex; align-items: center; justify-content: space-between; padding: 0 20px; box-sizing: border-box;
        }

        /* HUD */
        #game-ui { pointer-events: none; }
        .hud-element { pointer-events: auto; }
        
        /* VOLANTE VISUAL (TOPO) */
        #ui-wheel {
            position: absolute; top: 10px; left: 50%; transform: translateX(-50%);
            opacity: 0; transition: opacity 0.3s; z-index: 20;
        }
        .steering-wheel {
            width: 120px; height: 120px; border: 6px solid #ccc; border-radius: 50%;
            background: radial-gradient(circle, transparent 40%, rgba(0,0,0,0.8) 41%);
            position: relative;
        }
        .wheel-mark {
            position: absolute; top: -5px; left: 50%; transform: translateX(-50%);
            width: 8px; height: 15px; background: red;
        }

        .btn-action {
            background: linear-gradient(to bottom, #4facfe 0%, #00f2fe 100%);
            border: 2px solid white; color: white; padding: 15px 30px; border-radius: 50px;
            font-weight: bold; box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>

<div id="game-hardware">
    <video id="video-source" playsinline></video>
    <video id="webcam" autoplay muted playsinline></video>
    <canvas id="game-canvas"></canvas>
</div>

<div id="os-layer">
    <div id="screen-safety" class="screen" style="background: #fff; z-index: 100;">
        <div style="border:1px solid #ccc; padding:2rem; border-radius:8px; text-align:center; max-width:600px; background:#fff;">
            <h1 class="text-xl font-bold mb-4">Sa√∫de e Seguran√ßa</h1>
            <p class="mb-6 text-sm text-gray-600">‚ö†Ô∏è Certifique-se de ter espa√ßo livre ao redor.</p>
            <button onclick="System.boot()" class="btn-action animate-pulse">Tocar para Iniciar (A)</button>
            <div id="boot-log" class="mt-4 text-xs text-blue-500 font-mono"></div>
        </div>
    </div>

    <div id="screen-load" class="screen hidden" style="background:#000; color:#fff;">
        <div class="w-12 h-12 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin mb-4"></div>
        <p class="font-mono text-xs">CARREGANDO...</p>
    </div>

    <div id="screen-menu" class="screen hidden">
        <div class="wii-grid">
            <div onclick="System.launch('drive')" class="channel"><div class="channel-icon">üèéÔ∏è</div><div class="channel-name">Kart Wii</div></div>
            <div onclick="System.launch('run')" class="channel"><div class="channel-icon">üèÉ</div><div class="channel-name">Street Run</div></div>
            <div onclick="System.launch('fight')" class="channel"><div class="channel-icon">ü•ä</div><div class="channel-name">Wii Boxe</div></div>
            <div class="channel"><div class="channel-icon">üôÇ</div><div class="channel-name">Mii Channel</div></div>
            <div class="channel" style="background:#eee"></div><div class="channel" style="background:#eee"></div>
            <div class="channel" style="background:#eee"></div><div class="channel" style="background:#eee"></div>
        </div>
        <div class="bottom-bar">
            <div style="width:40px;height:40px;border-radius:50%;background:#eee;display:flex;align-items:center;justify-content:center;border:2px solid #aaa;color:#888;font-weight:bold;">Wii</div>
            <div id="clock" style="color:#666;font-weight:bold;">00:00</div>
        </div>
    </div>

    <div id="game-ui" class="screen hidden" style="background:transparent;">
        <button onclick="System.home()" class="hud-element absolute top-4 right-4 bg-blue-500 text-white w-10 h-10 rounded-full border-2 border-white font-bold shadow-lg">‚åÇ</button>
        
        <div class="absolute bottom-4 left-4 bg-black/60 px-4 py-2 rounded-full border border-white/30">
            <span class="text-[10px] text-cyan-300 block leading-none">SCORE</span>
            <div id="hud-score" class="text-2xl text-white leading-none font-mono">0</div>
        </div>

        <div id="game-msg" class="absolute top-1/3 w-full text-center text-5xl text-yellow-400 font-black drop-shadow-lg" style="text-shadow: 2px 2px 0 #000;"></div>

        <div id="ui-wheel">
            <div id="visual-wheel" class="steering-wheel">
                <div class="wheel-mark"></div>
            </div>
        </div>
        
        <div class="hud-element absolute bottom-4 right-20 bg-black/50 px-3 py-1 rounded-full">
             <input type="range" min="0.5" max="3.0" step="0.5" value="1.0" class="w-16 accent-cyan-400" oninput="System.setSens(this.value)">
        </div>
    </div>

    <div id="screen-over" class="screen hidden" style="background:rgba(255,255,255,0.95); z-index:60;">
        <h1 class="text-5xl font-black mb-2">FIM</h1>
        <div id="final-score" class="text-7xl font-bold mb-8 font-mono">0</div>
        <button onclick="System.menu()" class="btn-action">VOLTAR AO MENU</button>
    </div>
</div>

<script>
    /* üîä AUDIO */
    const Sfx = {
        ctx: null,
        init: () => { window.AudioContext = window.AudioContext||window.webkitAudioContext; Sfx.ctx=new AudioContext(); },
        play: (f,t,d,v=0.1) => {
            if(!Sfx.ctx)return;
            const o=Sfx.ctx.createOscillator(),g=Sfx.ctx.createGain();
            o.type=t;o.frequency.value=f;g.gain.setValueAtTime(v,Sfx.ctx.currentTime);
            g.gain.exponentialRampToValueAtTime(0.01,Sfx.ctx.currentTime+d);
            o.connect(g);g.connect(Sfx.ctx.destination);o.start();o.stop(Sfx.ctx.currentTime+d);
        },
        click:()=>Sfx.play(1200,'sine',0.1,0.1),
        coin:()=>Sfx.play(1500,'square',0.1,0.05),
        crash:()=>Sfx.play(80,'sawtooth',0.5,0.4),
        hit:()=>Sfx.play(150,'sawtooth',0.1,0.2)
    };

    /* üé® GRAPHICS */
    const Gfx = {
        mapPoint: (p, w, h) => ({ x: w - (p.x/640*w), y: p.y/480*h }), // Mapeamento correto
        
        // M√£os Virtuais no Volante (Feedback Visual)
        drawSteeringHands: (ctx, pose, w, h) => {
            if(!pose) return;
            const kp = pose.keypoints;
            const lw = kp.find(k=>k.name==='left_wrist');
            const rw = kp.find(k=>k.name==='right_wrist');
            
            // Desenha se tiver confian√ßa m√≠nima
            if(lw && rw && lw.score>0.3 && rw.score>0.3) {
                const p1 = Gfx.mapPoint(lw, w, h);
                const p2 = Gfx.mapPoint(rw, w, h);
                
                // Linha de Conex√£o (Eixo)
                ctx.beginPath(); ctx.moveTo(p1.x, p1.y); ctx.lineTo(p2.x, p2.y);
                ctx.strokeStyle = '#00ff00'; ctx.lineWidth = 4; ctx.setLineDash([5,5]); ctx.stroke(); ctx.setLineDash([]);
                
                // M√£os (Punhos)
                const r = w * 0.05;
                ctx.fillStyle = 'rgba(255, 0, 0, 0.8)'; 
                ctx.beginPath(); ctx.arc(p1.x, p1.y, r, 0, Math.PI*2); ctx.fill();
                ctx.beginPath(); ctx.arc(p2.x, p2.y, r, 0, Math.PI*2); ctx.fill();
                
                // Texto Guia
                ctx.fillStyle = "#fff"; ctx.font = "12px monospace"; ctx.textAlign="center";
                ctx.fillText("L", p1.x, p1.y+5); ctx.fillText("R", p2.x, p2.y+5);
            }
        },

        drawSkeleton: (ctx, pose, w, h) => {
            if(!pose) return;
            ctx.lineCap='round';ctx.strokeStyle='#00ffff';ctx.lineWidth=w*0.01;
            const kp=pose.keypoints;
            const bone=(n1,n2)=>{
                const p1=kp.find(k=>k.name===n1),p2=kp.find(k=>k.name===n2);
                if(p1&&p2&&p1.score>0.3&&p2.score>0.3){
                    const m1=Gfx.mapPoint(p1,w,h),m2=Gfx.mapPoint(p2,w,h);
                    ctx.beginPath();ctx.moveTo(m1.x,m1.y);ctx.lineTo(m2.x,m2.y);ctx.stroke();
                }
            };
            bone('left_shoulder','left_elbow');bone('left_elbow','left_wrist');
            bone('right_shoulder','right_elbow');bone('right_elbow','right_wrist');
            bone('left_shoulder','right_shoulder');
        },

        drawRoad: (ctx, w, h, pos, curve) => {
            const cx=w/2, hor=h*0.4;
            ctx.fillStyle='#111';ctx.fillRect(0,0,w,h); // Limpa tela
            ctx.fillStyle='#333';ctx.beginPath();
            const off=curve*(w*0.3);
            ctx.moveTo(cx+off-(w*0.05), hor); ctx.lineTo(cx+off+(w*0.05), hor);
            ctx.lineTo(cx+(w*1.2), h); ctx.lineTo(cx-(w*1.2), h); ctx.fill();
            
            ctx.strokeStyle='#ffeb3b';ctx.lineWidth=w*0.02;
            ctx.setLineDash([h*0.05, h*0.05]); ctx.lineDashOffset=-pos;
            ctx.beginPath();ctx.moveTo(cx+off, hor);
            ctx.quadraticCurveTo(cx+(off*0.5), h*0.7, cx, h); ctx.stroke(); ctx.setLineDash([]);
        }
    };

    /* üß† SYSTEM */
    const System = {
        video:null, canvas:null, ctx:null, detector:null,
        activeGame:null, loopId:null, sens:1.0,

        boot: async () => {
            document.getElementById('boot-log').innerText = "Iniciando...";
            Sfx.init(); Sfx.click();
            try {
                const stream = await navigator.mediaDevices.getUserMedia({video:{facingMode:'user',width:{ideal:640},height:{ideal:480}},audio:false});
                System.video=document.getElementById('video-source'); System.video.srcObject=stream;
                document.getElementById('webcam').srcObject=stream;
                await new Promise(r=>System.video.onloadedmetadata=r); System.video.play(); document.getElementById('webcam').play();
                
                document.getElementById('screen-safety').classList.add('hidden');
                document.getElementById('screen-load').classList.remove('hidden');

                await tf.setBackend('webgl');
                System.detector = await poseDetection.createDetector(poseDetection.SupportedModels.MoveNet, {modelType:poseDetection.movenet.modelType.SINGLEPOSE_LIGHTNING});

                System.canvas=document.getElementById('game-canvas'); System.ctx=System.canvas.getContext('2d');
                System.resize(); window.addEventListener('resize',System.resize);
                
                document.getElementById('screen-load').classList.add('hidden');
                System.menu();
            } catch(e){ alert("C√¢mera necess√°ria!"); }
        },

        menu: () => {
            if(System.loopId) cancelAnimationFrame(System.loopId);
            document.getElementById('screen-menu').classList.remove('hidden');
            document.getElementById('game-ui').classList.add('hidden');
            document.getElementById('screen-over').classList.add('hidden');
            document.getElementById('webcam').style.opacity='0';
        },

        launch: (g) => {
            Sfx.click(); System.activeGame=g;
            document.getElementById('screen-menu').classList.add('hidden');
            document.getElementById('game-ui').classList.remove('hidden');
            
            const cam = document.getElementById('webcam');
            const wheel = document.getElementById('ui-wheel');
            
            if(g==='drive') { Logic.Drive.init(); cam.style.opacity='0.6'; wheel.style.opacity='1'; }
            if(g==='run') { Logic.Run.init(); cam.style.opacity='0.3'; wheel.style.opacity='0'; }
            if(g==='fight') { Logic.Fight.init(); cam.style.opacity='0.3'; wheel.style.opacity='0'; }
            
            System.loop();
        },

        loop: async () => {
            if(!System.activeGame) return;
            const ctx=System.ctx, w=System.canvas.width, h=System.canvas.height;
            let pose=null;
            try{ const p=await System.detector.estimatePoses(System.video,{flipHorizontal:false}); if(p.length>0) pose=p[0]; }catch(e){}

            let s=0;
            if(System.activeGame==='drive') s=Logic.Drive.update(ctx,w,h,pose);
            if(System.activeGame==='run') s=Logic.Run.update(ctx,w,h,pose);
            if(System.activeGame==='fight') s=Logic.Fight.update(ctx,w,h,pose);
            
            document.getElementById('hud-score').innerText=s;
            System.loopId=requestAnimationFrame(System.loop);
        },

        home:()=>System.menu(),
        gameOver:(s)=>{ 
            cancelAnimationFrame(System.loopId); Sfx.crash();
            document.getElementById('final-score').innerText=s;
            document.getElementById('game-ui').classList.add('hidden');
            document.getElementById('screen-over').classList.remove('hidden');
        },
        resize:()=>{ if(System.canvas){System.canvas.width=window.innerWidth;System.canvas.height=window.innerHeight;} },
        setSens:(v)=>System.sens=parseFloat(v),
        msg:(t)=>{const e=document.getElementById('game-msg');e.innerText=t;setTimeout(()=>e.innerText='',1500);}
    };

    /* üéÆ GAME LOGIC */
    const Logic = {
        
        // KART - CAMADAS CORRIGIDAS
        Drive: {
            speed:0, pos:0, x:0, steer:0, curve:0, obs:[],
            init:()=>{ Logic.Drive.speed=0; Logic.Drive.pos=0; Logic.Drive.x=0; Logic.Drive.obs=[]; System.msg("M√ÉOS NO AR!"); },
            update:(ctx,w,h,pose)=>{
                const d=Logic.Drive, cx=w/2;
                
                // 1. INPUT
                let target=0;
                if(pose){
                    const kp=pose.keypoints, lw=kp.find(k=>k.name==='left_wrist'), rw=kp.find(k=>k.name==='right_wrist');
                    if(lw&&rw&&lw.score>0.3&&rw.score>0.3){
                        const dy=rw.y-lw.y, dx=rw.x-lw.x;
                        target=Math.atan2(dy,dx)*1.5*System.sens;
                        if(d.speed<h*0.05) d.speed+=h*0.0005;
                    } else { d.speed*=0.95; }
                }
                d.steer+=(target-d.steer)*0.2;
                document.getElementById('visual-wheel').style.transform=`rotate(${d.steer*57}deg)`;

                // 2. F√çSICA
                d.pos+=d.speed; d.curve=Math.sin(d.pos*0.005)*1.5;
                d.x+=d.steer*(d.speed/(h*0.5)); d.x-=d.curve*(d.speed/h);
                if(Math.abs(d.x)>1.3) d.speed*=0.9;

                // 3. OBST√ÅCULOS
                if(Math.random()<0.02 && d.speed>5) d.obs.push({x:(Math.random()*2)-1, z:1000});

                // 4. DESENHO (ORDEM CR√çTICA: ESTRADA -> CARRO -> M√ÉOS)
                Gfx.drawRoad(ctx,w,h,d.pos,d.curve); // Limpa e desenha fundo

                // Obst√°culos
                d.obs.forEach((o,i)=>{
                    o.z-=d.speed*2; if(o.z<-100){d.obs.splice(i,1);return;}
                    const s=500/(o.z+100);
                    if(s>0 && o.z<1000){
                        const off=d.curve*(w*0.3)*(1-(o.z/1000));
                        const ox=cx+off+(o.x*w*0.5*s), oy=(h*0.4)+(50*s), sz=(w*0.08)*s;
                        ctx.fillStyle='#ff9900'; ctx.beginPath(); ctx.moveTo(ox,oy-sz); ctx.lineTo(ox-sz/2,oy); ctx.lineTo(ox+sz/2,oy); ctx.fill();
                        if(o.z<100 && o.z>0 && Math.abs(d.x-o.x)<0.3){
                            d.speed*=0.5; Sfx.crash(); d.obs.splice(i,1); ctx.fillStyle='red'; ctx.fillRect(0,0,w,h);
                        }
                    }
                });

                // Carro
                const carX = cx + (d.x * w * 0.25);
                ctx.save(); ctx.translate(carX, h*0.85); ctx.rotate(d.steer); const s=w*0.003; ctx.scale(s,s);
                ctx.fillStyle='#d00'; ctx.beginPath(); ctx.roundRect(-20,-20,40,40,5); ctx.fill();
                ctx.fillStyle='#111'; ctx.fillRect(-15,-10,30,10);
                ctx.restore();

                // 5. M√ÉOS VIRTUAIS (DESENHADAS POR √öLTIMO PARA APARECEREM)
                Gfx.drawSteeringHands(ctx, pose, w, h);

                return Math.floor(d.pos/100);
            }
        },

        // RUN - L√ìGICA CORRIGIDA (ZONAS AJUSTADAS)
        Run: {
            lane:0, score:0, frame:0, obs:[],
            init:()=>{ Logic.Run.score=0; Logic.Run.obs=[]; System.msg("CORRA!"); },
            update:(ctx,w,h,pose)=>{
                const r=Logic.Run, cx=w/2; r.frame++;
                
                // ZONAS DE DETEC√á√ÉO (Espelho: Esquerda F√≠sica = Direita na Tela/C√¢mera)
                // C√¢mera raw: 0 (Esq Tela) a 640 (Dir Tela).
                // Espelhado via CSS.
                // Se nariz.x < 240 (Ter√ßo esquerdo da imagem) -> Usuario foi pra Direita F√≠sica (Direita Tela espelhada)
                // Se nariz.x > 400 (Ter√ßo direito da imagem) -> Usuario foi pra Esquerda F√≠sica (Esquerda Tela espelhada)
                if(pose){
                    const n=pose.keypoints.find(k=>k.name==='nose');
                    if(n && n.score>0.4){
                        if(n.x < 250) r.lane=1;       // Direita
                        else if(n.x > 390) r.lane=-1; // Esquerda (CORRIGIDO)
                        else r.lane=0;                // Centro
                    }
                }

                if(r.frame%50===0) r.obs.push({l:Math.floor(Math.random()*3)-1, z:1000});
                
                ctx.clearRect(0,0,w,h);
                ctx.fillStyle='#111'; ctx.fillRect(0,0,w,h);
                ctx.strokeStyle='#00ffcc'; ctx.lineWidth=1;
                ctx.beginPath(); ctx.moveTo(cx-(w*0.3), h/2); ctx.lineTo(0,h); ctx.stroke();
                ctx.beginPath(); ctx.moveTo(cx+(w*0.3), h/2); ctx.lineTo(w,h); ctx.stroke();

                r.obs.forEach((o,i)=>{
                    o.z-=20; if(o.z<-100){r.obs.splice(i,1); r.score+=10; Sfx.coin(); return;}
                    const s=500/(o.z+100);
                    if(s>0){
                        const ox=cx+(o.l*w*0.3*s), oy=h/2+(50*s), sz=w*0.15*s;
                        ctx.fillStyle='#f03'; ctx.fillRect(ox-sz/2, oy, sz, sz);
                        if(o.z<50 && o.z>-50 && o.l===r.lane) System.gameOver(r.score);
                    }
                });

                // Jogador
                ctx.save(); ctx.translate(cx+(r.lane*w*0.25), h*0.85); ctx.scale(w*0.005, w*0.005);
                ctx.strokeStyle='#0f0'; ctx.lineWidth=3;
                ctx.beginPath(); ctx.moveTo(0,0); ctx.lineTo(0,-20); ctx.stroke(); // Tronco
                const osc = Math.sin(r.frame*0.4)*10;
                ctx.beginPath(); ctx.moveTo(0,0); ctx.lineTo(-10+osc, 25); ctx.stroke(); // Perna 1
                ctx.beginPath(); ctx.moveTo(0,0); ctx.lineTo(10-osc, 25); ctx.stroke(); // Perna 2
                ctx.fillStyle='#fff'; ctx.beginPath(); ctx.arc(0,-25,6,0,Math.PI*2); ctx.fill(); // Cabe√ßa
                ctx.restore();
                
                return r.score;
            }
        },

        // BOXE - MANTIDO
        Fight: {
            score:0, targets:[], last:0,
            init:()=>{ Logic.Fight.score=0; Logic.Fight.targets=[]; System.msg("BOXE!"); },
            update:(ctx,w,h,pose)=>{
                const f=Logic.Fight, now=Date.now();
                ctx.clearRect(0,0,w,h);
                Gfx.drawSkeleton(ctx,pose,w,h);
                let hits=[];
                if(pose){
                    const kp=pose.keypoints, lw=kp.find(k=>k.name==='left_wrist'), rw=kp.find(k=>k.name==='right_wrist');
                    if(lw&&lw.score>0.3) hits.push(Gfx.mapPoint(lw,w,h));
                    if(rw&&rw.score>0.3) hits.push(Gfx.mapPoint(rw,w,h));
                }
                if(now-f.last>800){
                    f.targets.push({x:Math.random()*(w*0.8)+w*0.1, y:Math.random()*(h*0.5)+h*0.1, r:w*0.08, s:now});
                    f.last=now;
                }
                f.targets.forEach((t,i)=>{
                    const age=(now-t.s)/1500; if(age>1){f.targets.splice(i,1);return;}
                    ctx.beginPath(); ctx.arc(t.x,t.y,t.r,0,Math.PI*2);
                    ctx.fillStyle=`rgba(255,255,0,${1-age})`; ctx.fill(); ctx.stroke();
                    hits.forEach(h=>{ if(Math.hypot(h.x-t.x, h.y-t.y)<t.r*1.5){f.targets.splice(i,1);f.score+=100;Sfx.hit();} });
                });
                return f.score;
            }
        }
    };
    
    // Rel√≥gio
    setInterval(()=>{document.getElementById('clock').innerText=new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})},1000);
</script>
</body>
</html>
